{% extends "base.html" %}

{% block content %}
<div class="container">
    <!-- Search Section -->
    <section class="search-section">
        <h2>Search Videos</h2>
        <form id="search-form" class="search-form">
            <div class="form-row">
                <div class="form-group">
                    <label for="max_width">Max Width:</label>
                    <input type="number" id="max_width" name="max_width">
                </div>
                <div class="form-group">
                    <label for="max_height">Max Height:</label>
                    <input type="number" id="max_height" name="max_height">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="max_bitrate">Max Bitrate:</label>
                    <input type="text" id="max_bitrate" name="max_bitrate" placeholder="e.g., 1000k">
                </div>
                <div class="form-group">
                    <label for="max_framerate">Max Framerate:</label>
                    <input type="number" id="max_framerate" name="max_framerate" step="0.1">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="codec">Codec:</label>
                    <input type="text" id="codec" name="codec" placeholder="e.g., h264">
                </div>
                <div class="form-group">
                    <label for="path">Path (optional):</label>
                    <input type="text" id="path" name="path" placeholder="Partial path to filter">
                </div>
            </div>
            <button type="submit" class="btn btn-primary">Search</button>
        </form>
    </section>

    <!-- Results Section -->
    <section class="results-section" style="display: none;">
        <h2>Search Results</h2>
        <div class="results-controls">
            <div class="selection-controls">
                <button id="select-all" class="btn btn-secondary">Select All</button>
                <button id="select-none" class="btn btn-secondary">Select None</button>
                <button id="select-invert" class="btn btn-secondary">Invert Selection</button>
            </div>
            <button id="convert-videos" class="btn btn-primary">Convert Selected Videos</button>
        </div>

        <div class="table-container">
            <table id="results-table" class="data-table">
                <thead>
                    <tr>
                        <th><input type="checkbox" id="select-all-checkbox"></th>
                        <th data-sort-original="title" data-sort="title">Title</th>
                        <th data-sort-original="duration" data-sort="duration">Duration</th>
                        <th data-sort-original="size" data-sort="size">File Size</th>
                        <th data-sort-original="codec" data-sort="codec">Codec</th>
                        <th data-sort-original="width" data-sort="width">Width</th>
                        <th data-sort-original="height" data-sort="height">Height</th>
                        <th data-sort-original="bitrate" data-sort="bitrate">Bitrate</th>
                        <th data-sort-original="framerate" data-sort="framerate">FPS</th>
                        <th>Path</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <div class="pagination-controls">
            <select id="page-size">
                <option value="50">50</option>
                <option value="100">100</option>
                <option value="250">250</option>
                <option value="500">500</option>
                <option value="1000">1000</option>
                <option value="all">All</option>
            </select>
            <div class="pagination-buttons">
                <button id="prev-page" class="btn btn-secondary">Previous</button>
                <span id="page-info">Page 1 of 1</span>
                <button id="next-page" class="btn btn-secondary">Next</button>
            </div>
        </div>
    </section>

    <!-- Conversion Section -->
    <section class="conversion-section" style="display: none;">
        <h2>Conversion Queue</h2>
        <div class="conversion-controls">
            <button id="cancel-all" class="btn btn-danger">Cancel All</button>
            <button id="clear-completed" class="btn btn-secondary">Clear Completed</button>
        </div>

        <div class="progress-overview">
            <div class="progress-bar">
                <div id="overall-progress" class="progress-fill"></div>
            </div>
            <div id="progress-text">0% Complete</div>
            <div id="eta-text">ETA: Calculating...</div>
        </div>

        <div class="table-container">
            <table id="conversion-table" class="data-table">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Status</th>
                        <th>Progress</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </section>
</div>

<!-- Log Modal -->
<div id="log-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Conversion Log</h2>
            <span class="close">&times;</span>
        </div>
        <div class="modal-body">
            <pre id="log-content"></pre>
        </div>
    </div>
</div>

<script>
    // Show settings modal on first run
    document.addEventListener('DOMContentLoaded', function() {
        const showSettings = document.body.getAttribute('data-show-settings') === 'true';
        if (showSettings) {
            setTimeout(() => {
                if (typeof app !== 'undefined') {
                    app.showSettingsModal();
                }
            }, 500);
        }
    });
</script>
{% endblock %}
